(this["webpackJsonpbodega-products"]=this["webpackJsonpbodega-products"]||[]).push([[0],{123:function(e,t){},130:function(e,t,a){},131:function(e,t,a){},132:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(9),o=a.n(r),s=(a(72),a(73),a(20)),i=a(6),l=(a(35),a(7)),u=a.n(l),m=a(22),d={};d=a(91);var p=Object(m.a)({},{port:4020},{},d),f=a(62),h=a.n(f),E=null,v=a(4),g=(a(18),a(63)),b=a.n(g),N=a(64),k=a.n(N),y=a(8);v.a.configure();var j=function(e){var t=Object(n.useState)(0),a=Object(i.a)(t,2),r=a[0],o=a[1],s=Object(n.useState)(e.request),l=Object(i.a)(s,2),d=l[0],f=l[1];Object(n.useEffect)((function(){var e=setInterval((function(){o(r+1);var e=Math.abs(new Date(d.date)-new Date);f(Object(m.a)({},d,{minutes:h(e)}))}),1e3);return function(){clearInterval(e)}}));var h=function(e){var t=(e/1e3).toFixed(0),a=Math.floor(t/60),n="";return a>59&&(a=(a-=60*(n=(n=Math.floor(a/60))>=10?n:"0"+n))>=10?a:"0"+a),t=(t=Math.floor(t%60))>=10?t:"0"+t,""!=n?n+":"+a+":"+t:a+":"+t};return c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"username ".concat(d.minutes<=15?"green":d.minutes>15&&d.minutes<=30?"orange":"red")},d.to),c.a.createElement("div",{className:"content"},d.products.map((function(e,t){return t>=12?null:t<=10?c.a.createElement("p",{key:t,className:e.status},e.nombre):c.a.createElement("div",{className:"more",key:t},d.products.length," m\xe1s")}))),c.a.createElement("div",{className:"footer"},c.a.createElement("div",{className:"info"},"Hace ",d.minutes),c.a.createElement("div",{className:"printer",onClick:function(){console.log(d.id),u.a.post("".concat(p.urlPrinter,"print"),{request:d}).then((function(e){console.log("impresoe",e)})).catch((function(e){console.log(e)}))}},c.a.createElement("img",{src:k.a,alt:"Imprimir"})),c.a.createElement("div",{className:"eye"},c.a.createElement(y.b,{to:"/request-product-detail/".concat(d.id)},c.a.createElement("img",{src:b.a,alt:"Detalle"})))))};v.a.configure();var O=[],w=function(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),r=a[0],o=a[1];return Object(n.useEffect)((function(){speechSynthesis.getVoices(),setTimeout((function(){O=speechSynthesis.getVoices(),speechSynthesis.getVoices().forEach((function(e){}))}),1e3),new Promise((function(e,t){null!==localStorage.getItem("token")&&((E=h.a.connect("http://app.ferregomezjp.co/signaling",{transports:["websocket"],upgrade:!0,path:"/signaling/socket.io",query:{token:localStorage.getItem("token")}})).on("reconnect_attempt",(function(){E.io.opts.transports=["polling","websocket"]})),e({status:!0}))})).then((function(){E.on("enviarPedidoBodega",(function(e){var t=speechSynthesis.getVoices().findIndex((function(e){return"Paulina"===e.name})),a=new SpeechSynthesisUtterance;a.text=e.nombre_voz,a.voice=O[t],speechSynthesis.speak(a);var n=Math.abs(new Date(e.date)-new Date),c=Math.floor(n/1e3/60);e.minutes=c,o((function(t){return[].concat(Object(s.a)(t),[e])}))})),u.a.post("".concat(p.host,"api/obtenerSolicitudes"),{}).then((function(e){e.data.status&&o(e.data.requests)})).catch((function(e){console.log(e)}))}))}),[]),c.a.createElement("div",{className:"request-products"},c.a.createElement("div",{className:"request-products-header"},c.a.createElement("div",{className:"request-products-header-name"}),c.a.createElement("div",{className:"request-products-header-quantity"},r.length)),c.a.createElement("div",{className:"request-products-content"},r.map((function(e,t){return c.a.createElement(j,{key:t,request:e})}))))},S=(a(130),a(66)),q=a.n(S),C=a(33),x=a.n(C);v.a.configure();var I=function(e){var t=Object(n.useState)(e.match.params.id),a=Object(i.a)(t,1)[0],r=Object(n.useState)({}),o=Object(i.a)(r,2),l=o[0],m=o[1],d=Object(n.useState)([]),f=Object(i.a)(d,2),h=f[0],E=f[1];x()("input").on("click",(function(){x()(this).select()})),Object(n.useEffect)((function(){u.a.post("".concat(p.host,"api/obtenerProductoPedido"),{id:e.match.params.id}).then((function(e){console.log("response.data",e.data),E(e.data.products),m(e.data.request)})).catch((function(e){console.log(e)}))}),[e]);var g=function(e){return function(t){if("pending"===e.status){var a=h.map((function(t){return t.id===e.id?t.showMenu=!0:t.showMenu=!1,t}));E(a)}}},b=function(e){return function(t){var a=h.map((function(t){return t.id===e.id&&(t.showMenu=!1),t}));E(a)}},N=function(e){return function(t){var a=h.map((function(a){return Number(t.target.value)<=e.cantidad&&Number(t.target.value)>0?a.id===e.id&&(a.quantityWrite=Number(t.target.value),a.error=!1):a.error=!0,a}));E(a)}},k=function(e,t){return function(n){e.quantityWrite>0&&!e.error?u.a.post("".concat(p.host,"api/actualizarEstadoProductoPedido"),{id:a,product:e,status:t}).then((function(a){if(a.data.status){var n=0,c=h.map((function(a){return"check"!==a.status&&"cancel"!==a.status||n++,a.id===e.id&&(n++,a.status=t,a.showMenu=!1),a}));E([].concat(Object(s.a)(h),[c])),n===h.length&&j()}else v.a.error(a.data.message)})).catch((function(e){console.log(e)})):v.a.dark("Cantidad no permitida")}},j=function(){u.a.post("".concat(p.host,"api/finalizarPedido"),{id:a,status:"finished"}).then((function(t){t.data.status?e.history.push("/request-product"):v.a.error(t.data.message)})).catch((function(e){console.log(e)}))};return c.a.createElement(n.Fragment,null,c.a.createElement("div",{className:"back"},c.a.createElement(y.b,{to:"/request-product"},"Atras")),c.a.createElement("div",{className:"header"},c.a.createElement("h1",null,l?l.para:"")),c.a.createElement("div",{className:"body"},c.a.createElement("table",null,c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"PRODUCTO"),c.a.createElement("th",null,"CANTIDAD"),c.a.createElement("th",null,"ACCI\xd3N"))),c.a.createElement("tbody",null,h.map((function(e,t){return c.a.createElement("tr",{key:t},c.a.createElement("td",{className:e.status},e.nombre),c.a.createElement("td",{className:e.status},e.cantidad),c.a.createElement("td",{className:e.status},c.a.createElement("div",{onClick:g(e)},e.nombre),c.a.createElement("div",{className:"menu",style:{display:e.showMenu?"block":"none"}},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"name"},e.nombre),c.a.createElement("div",{className:"close",onClick:b(e)},c.a.createElement("img",{src:q.a,alt:"Cerrar"}))),c.a.createElement("div",{className:"body"},c.a.createElement("input",{type:"number",onChange:N(e)})),c.a.createElement("div",{className:"footer"},c.a.createElement("button",{onClick:k(e,"check")},"Enviar"),c.a.createElement("button",{className:"negative",onClick:k(e,"cancel")},"Sin existencias"),e.error?c.a.createElement("div",{className:"error"},"Cantidad no permitida"):""))))}))))))};a(131);v.a.configure();var M=function(e){var t=Object(n.useState)(""),a=Object(i.a)(t,2),r=a[0],o=a[1],s=function(){u.a.post("".concat(p.host,"api/login-bodega"),{password:r}).then((function(t){var a;console.log(t.data),t.data.token?(a=t.data.token,localStorage.setItem("token",a),e.history.push("/request-product")):v.a.error(t.data.message)})).catch((function(e){console.log(e)}))};return c.a.createElement("div",{className:"login-wrapper"},c.a.createElement("div",{className:"login"},c.a.createElement("div",{className:"header"},"INICIAR SESION"),c.a.createElement("div",{className:"body"},c.a.createElement("input",{type:"text",value:r,onChange:function(e){o(e.target.value)}})),c.a.createElement("div",{className:"footer"},c.a.createElement("button",{onClick:function(){return s()}},"INGRESAR"))))},P=(a(21),a(1)),A=function(e){return Object(n.useEffect)((function(){}),[]),c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App-header"},"Solicitudes de productos",c.a.createElement("div",{className:"App-bell-wrapper"})),c.a.createElement("section",{className:"App-content"},c.a.createElement(y.a,null,c.a.createElement(P.d,null,c.a.createElement(P.b,{component:M,path:"/",exact:!0}),c.a.createElement(P.b,{component:w,path:"/request-product",exact:!0}),c.a.createElement(P.b,{component:I,path:"/request-product-detail/:id",exact:!0})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},35:function(e,t,a){},44:function(e,t){e.exports={host:"http://app.ferregomezjp.co/signaling/",urlPrinter:"http://localhost:4000/"}},63:function(e,t,a){e.exports=a.p+"static/media/eye.4b4cf493.svg"},64:function(e,t,a){e.exports=a.p+"static/media/printer.bc576d92.svg"},66:function(e,t,a){e.exports=a.p+"static/media/cancel.e3741d9b.svg"},67:function(e,t,a){e.exports=a(132)},72:function(e,t,a){},73:function(e,t,a){},91:function(e,t){e.exports={host:"http://app.ferregomezjp.co/signaling/",urlPrinter:"http://localhost:4000/"}},92:function(e,t){e.exports={host:"172.17.160.142"}}},[[67,1,2]]]);
//# sourceMappingURL=main.1fdc59c6.chunk.js.map